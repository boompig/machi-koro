<!DOCTYPE html>
<html ng-app="MachiKoroSimul">
	<head>
		<title>Machi Koro Simulation</title>
		<meta charset="utf-8" />
		<!-- CDN-hosted bootstrap -->
		<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css" />

		<link rel="stylesheet" href="css/visual.css" />
	</head>
	<body ng-controller="MachiKoroCtrl as game" ng-init="onLoad(game)">
		<div id="main-container">
			<div id="dice-container" ng-class="{ newDice: animateDice }">
				<span ng-if="game.lastRoll !== null">
					<img class="dice-img" 
					ng-src="images/dice/dice-{{ game.lastRoll[0] }}.png" />
					<img class="dice-img" ng-if="game.lastRoll.length > 1"
					ng-src="images/dice/dice-{{ game.lastRoll[1] }}.png" />
				</span>
			</div>

			<div id="deck-container">
				<h4 class="section-title">Deck</h4>
				<div class="card vis-card" ng-repeat="cardName in getDeck(game)">
					<img class="card-img selectable-card" ng-src="images/cards/{{ cardName.toLowerCase() }}" alt="{{ getCardDescription(cardName) }}"
					ng-class="{ disabled: (!game.canBuyCard(cardName, game.getCurrentPlayer()) || !game.getCurrentPlayer().isHuman) }"
					ng-click="game.buyCard(cardName, game.getCurrentPlayer())" />
					<div class="card-name">
						<span>{{ getDeckQty(game, cardName) }} x</span>
						<span>{{ getCardName(cardName) }}</span>
					</div>
				</div>
			</div>

			<div id="player-container">
				<div class="player" ng-repeat="player in game.players" id="{{ player.name }}"
					ng-class="{ playerTurn: game.isPlayerTurn(player) }">
					<div class="player-name" ng-class="{ playerTurn: game.isPlayerTurn(player) }">
						<span>{{ player.name }}</span><!-- 
						<div>E[1, myTurn] = {{ game.getPlayerExpectedValueYourTurn(player)[1] }}</div>
						<div>E[1, allTurns] = {{ game.getPlayerExpectedValueAllTurns(player)[1] }}</div>
						<div>E[2, myTurn] = {{ game.getPlayerExpectedValueYourTurn(player)[2] }}</div>
						<div>E[2, allTurns] = {{ game.getPlayerExpectedValueAllTurns(player)[2] }}</div> -->
					</div>

					<div class="plus-money" ng-show="plusMoney[player.name]"
					ng-class="{ fadeOut: plusMoney[player.name] }">+{{ plusMoney[player.name] }}</div>
					<div class="minus-money" ng-show="minusMoney[player.name]"
					ng-class="{ fadeOut: minusMoney[player.name] }">-{{ minusMoney[player.name] }}</div>

					<div class="player-money">Money: {{ player.money }}</div>
					<div class="player-cards">
						<div ng-repeat="cardName in getSortedPlayerCards(player)" class="card vis-card">
							<img class="card-img" ng-src="images/cards/{{ cardName }}.png" alt="{{ getCardDescription(cardName) }}" />
							<div class="card-name">
								<span>{{ getCardQty(cardName, player) }} x</span>
								<span>{{ getCardName (cardName) }}</span>
							</div>
							<div class="card-yield">
								<span>Yields {{ game.getCardYield(player, cardName) ? game.getCardYield(player, cardName).amt : "nothing" }}</span>
								<!-- <div>E[1, myTurn] = {{ game.getCardExpectedValueYourTurn(player, cardName)["1"] }}</div>
								<div>E[1, allTurns] = {{ game.getCardExpectedValueAllTurns(player, cardName)["1"] }}</div>
								
								<div>E[2, myTurn] = {{ game.getCardExpectedValueYourTurn(player, cardName)["2"] }}</div>
								<div>E[2, allTurns] = {{ game.getCardExpectedValueAllTurns(player, cardName)["2"] }}</div> -->
							</div>
						</div>
					</div>
					<div class="player-after"></div>
				</div>
			</div>

			<div id="btn-panel">
				<span ng-show="game.getCurrentPlayer().isHuman" class="human-panel">
					<button class="btn btn-primary" ng-click="game.rollDice(1)" ng-show="game.state === 'ROLL'"
					ng-disabled="game.state !== 'ROLL'">Roll 1 Die</button>
					<button class="btn btn-primary" ng-click="game.rollDice(2)" ng-show="game.state === 'ROLL'"
					ng-disabled="game.state !== 'ROLL' || !game.getCurrentPlayer().canRollTwoDice()">Roll 2 Dice</button>
					<button class="btn btn-danger" ng-click="endHumanTurn(game)" ng-show="game.state === 'BUY'"
					ng-disabled="game.state !== 'BUY'">End Turn</button>
				</span>
				<span ng-hide="game.getCurrentPlayer().isHuman" class="bot-panel">
					<button class="btn btn-primary" ng-click="doTurn(game)"
					ng-disabled="game.state !== 'ROLL' || animateDice">Evaluate {{ game.getCurrentPlayer().name }}'s Turn</button>
				</span>
				<button class="btn btn-info" ng-click="newGame(game)">New Game</button>
			</div>

			<div id="game-over" ng-show="game.state === 'GAME_OVER'"
			ng-class="{ gameOver : game.state === 'GAME_OVER' }">Game Over</div>
		</div>

		<footer>Turn {{ game.turn }}</footer>

		<!-- google-hosted JQuery and Angular -->
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
		<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.14/angular.js"></script>

		<script src="js/utils.js"></script>

		<script src="js/cards.js"></script>
		<script src="js/player.js"></script>
		<script src="js/machi_koro_ctrl.js"></script>
		<script src="js/angular_loader.js"></script>
	</body>
</html>